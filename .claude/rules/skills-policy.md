# スキル実行ポリシー

このファイルは、Claude Codeのスキル機能の使用に関するルールを定義します。

## 基本方針

### メインエージェントからのスキル呼び出し禁止

**重要: メインエージェント（あなた）は、Skillツールを使用してスキルを呼び出してはいけません。**

- **禁止事項**:
  - メインエージェントから `/architecture-check`, `/code-review`, `/pr-review`, `/security-check` などのスキルを自動的に実行すること
  - ユーザーの要求を解釈して、勝手にスキルを呼び出すこと

- **許可事項**:
  - ユーザーが明示的に「`/architecture-check` を実行して」と指示した場合のみ、Skillツールを使用できます

## 理由

- **ユーザーの意図を尊重**: ユーザーがスキルを実行したいタイミングを自分で制御できるようにします
- **予期しない動作の防止**: メインエージェントが勝手にスキルを実行して、作業が中断されることを防ぎます
- **透明性の確保**: すべての動作をユーザーが把握できるようにします

## 例外ケース

以下の場合のみ、Skillツールの使用が許可されます：

1. **ユーザーの明示的な指示**:
   ```
   ユーザー: 「/code-review を実行して」
   アシスタント: [Skillツールを使用して code-review を実行]
   ```

2. **ユーザーが "/<skill-name>" 形式で直接指示**:
   ```
   ユーザー: 「/pr-review」
   アシスタント: [Skillツールを使用して pr-review を実行]
   ```

3. **サブエージェント（Taskツールで起動されたエージェント）からの呼び出し**:
   - サブエージェント（architecture-advisor、Plan、Explore、general-purposeなど）は、必要に応じて自由にSkillツールを使用できます
   - これにより、サブエージェントが専門的なタスクを実行する際に、適切なスキルを活用できます
   - 例:
     ```
     メインエージェント: [Taskツールでarchitecture-advisorを起動]
     architecture-advisorサブエージェント: [/architecture-check スキルを実行] ← これは許可
     ```

## 禁止されている動作の例

❌ **間違った動作**:
```
ユーザー: 「新しい認証機能を実装したので、レビューしてください」
アシスタント: [勝手に /code-review スキルを実行] ← これは禁止
```

✅ **正しい動作**:
```
ユーザー: 「新しい認証機能を実装したので、レビューしてください」
アシスタント: 実装内容を確認します。コードをレビューしますね。
[Skillツールを使わずに、直接ファイルを読んでレビュー]
```

または、ユーザーにスキル実行を提案する（ただし自動実行はしない）:
```
ユーザー: 「新しい認証機能を実装したので、レビューしてください」
アシスタント: 承知しました。詳細なレビューが必要な場合は `/code-review` スキルを実行することもできますが、
まずは実装内容を確認させてください。
[ファイルを読んで内容を確認]
```

## まとめ

- **原則**: メインエージェントからSkillツールを呼び出さない
- **例外**:
  - ユーザーが明示的に指示した場合のみ
  - サブエージェント（Taskツールで起動）は自由に使用可能
- **目的**: ユーザーの制御権を保ち、予期しない動作を防ぐ
